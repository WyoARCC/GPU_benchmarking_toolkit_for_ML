#!/bin/bash
mkdir Graphs
echo -e "\e[1m\e[33m+--------------------------+\e[0m"
echo -e "\e[1m\e[33m| Activating Environment   |\e[0m"
echo -e "\e[1m\e[33m+--------------------------+\e[0m"
source activate gpt2_nrp
echo -e "\e[1m\e[33m+--------------------------+\e[0m"
echo -e "\e[1m\e[33m| Starting GPU Measurement |\e[0m"
echo -e "\e[1m\e[33m+--------------------------+\e[0m"
gpustat -a -i 30 > gpustat_gpt2.log 2>&1 &
echo "                                                                                                    "
echo "   ________________________________________________________________________________________________ "
echo "  /_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/ "
echo " ._.      _________ __                 __  .__                   _____________________________  ._. "
echo " | |     /   _____//  |______ ________/  |_|__| ____    ____    /  _____/\______   \__    ___/  | | "
echo " |_|     \_____  \\   __\__  \\_  __ \   __\  |/    \  / ___\  /   \  ___ |     ___/ |    |     |_| "
echo " |-|     /        \|  |  / __ \|  | \/|  | |  |   |  \/ /_/  > \    \_\  \|    |     |    |     |-| "
echo " | |    /_______  /|__| (____  /__|   |__| |__|___|  /\___  /   \______  /|____|     |____|     | | "
echo " |_|            \/           \/                    \//_____/           \/                       |_| "
echo " ._.                            ___________              __                                     ._. "
echo " | |                            \__    ___/___   _______/  |_                                   | | "
echo " |_|                              |    |_/ __ \ /  ___/\   __\                                  |_| "
echo " |-|                              |    |\  ___/ \___ \  |  |                                    |-| "
echo " | |                              |____| \___  >____  > |__|                                    | | "
echo " |_|                                         \/     \/                                          |_| "
echo " ._.                                                                                            ._. "
echo " | |    ____________________________________________________________________________________    | | "
echo " |_|   /_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/_____/    |_| "

accelerate launch main.py
echo "Generating Graphs"
python Plot_nonGPU_functions.py

source deactivate