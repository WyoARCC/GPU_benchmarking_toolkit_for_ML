#!/bin/bash

echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo "Checking GPU!"
echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo ""
echo ""
nvidia-smi
nvcc --version
echo ""
echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo "Getting Dataset!"
echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo ""
echo ""
time bash scripts/download_dataset.sh
echo ""
echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo "Preparing Dataset!"
echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo ""
echo ""
time bash scripts/prepare_dataset.sh
echo ""
echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo "Training!"
echo "---------------------------------------------------------------------------------------------------------------------------------------------"
echo ""
echo ""
export CUDA_VISIBLE_DEVICES=0
time NUM_GPUS=1 GRAD_ACCUMULATION=16 EPOCS=250 bash scripts/train.sh
